# QC Metrics Parquet Converter

This project contains a Python script for processing quality control (QC) metrics from multiple CSV files and saving the results as a Parquet file. It uses the [Polars](https://www.pola.rs/) library for fast, efficient data manipulation.

Dependencies are handled with [uv](https://docs.astral.sh/uv/).

## Project Structure

- `qc_data/` : Directory containing all the input CSV files.
- `qc_metrics.parquet` : Output Parquet file generated by the script.
- `import_data.py` : Main Python script.

## CSV File Format

The input CSV files should be named in the following format:

```
<SAMPLE_ID>_<OTHER_ID>_Lane<LANE_ID>.mapping_metrics.csv
```

For example: `259154_02_Lane2.mapping_metrics.csv`.

### CSV Content

Each CSV file contains the following columns:

- `type`
- `adapter`
- `metric`
- `value`
- `percent`

The columns are separated by commas (`,`) and there is no header row in the CSV files.

## Script Description

The script does the following:

1. Iterates over all CSV files in the `qc_data` directory.
2. Extracts information from the filename:
   - `Sample_Name` in the format `<SAMPLE_ID>_<OTHER_ID>`.
   - `Lane_Id` as an integer.
3. Reads the CSV file into a Polars DataFrame.
4. Filters out rows where the `type` is not "MAPPING/ALIGNING SUMMARY".
5. Drops the `type` and `adapter` columns from the DataFrame.
6. Adds `Sample_Name` and `Lane_Id` columns to the DataFrame.
7. Concatenates all DataFrames and saves them as a Parquet file named `qc_metrics.parquet`.
8. Prints a sample of 5 rows from the resulting DataFrame.

## Running the Script

To run the script, use the following command:

```bash
uv run import_data.py
```

Make sure the `qc_data` directory exists in the same location as the script and contains the required CSV files.

## Example Output

After running the script, a Parquet file named `qc_metrics.parquet` will be created in the current directory. The output file can be used for further data analysis and is suitable for fast reading and writing operations.
